<div class="bg-white shadow-2xl rounded-xl p-8 border-t-4 border-yellow-500">
  <!-- Header -->
  <div class="flex justify-between items-center mb-8">
    <h2 class="text-3xl font-extrabold text-gray-800 flex items-center space-x-3">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-8 w-8 text-lime-600">
        <path fill-rule="evenodd"
          d="M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653ZM12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438A7.486 7.486 0 0 1 12 15ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"
          clip-rule="evenodd" />
      </svg>
      <span>Usuarios Registrados</span>
    </h2>

    <button (click)="abrirModal()"
      class="bg-yellow-500 text-gray-900 font-bold px-6 py-2 rounded-xl shadow-lg hover:bg-yellow-600 hover:scale-105 transition duration-300 transform flex items-center space-x-2">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
        class="h-5 w-5">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z" />
      </svg>
      <span>Nuevo Usuario</span>
    </button>
  </div>

  <!-- Tabla de usuarios -->
  <div class="overflow-x-auto border border-gray-200 rounded-lg">
    <table class="min-w-full text-gray-700 border-collapse">
      <thead class="bg-gray-800 text-white">
        <tr>
          <th class="px-6 py-3 text-left text-sm font-semibold uppercase tracking-wider rounded-tl-lg text-lime-400">
            Nombre</th>
          <th class="px-6 py-3 text-left text-sm font-semibold uppercase tracking-wider text-lime-400">Email</th>
          <th class="px-6 py-3 text-left text-sm font-semibold uppercase tracking-wider text-lime-400">Teléfono</th>
          <th class="px-6 py-3 text-left text-sm font-semibold uppercase tracking-wider text-lime-400">Rol</th>
          <th class="px-6 py-3 text-left text-sm font-semibold uppercase tracking-wider rounded-tr-lg text-lime-400">
            Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let u of usuarios; trackBy: trackByUserId"
          class="hover:bg-lime-50/50 transition-colors border-b border-gray-100">
          <td class="px-6 py-3 font-medium text-gray-900">{{ u.nombre }}</td>
          <td class="px-6 py-3 text-gray-600">{{ u.email }}</td>
          <td class="px-6 py-3 text-gray-600">{{ u.telefono }}</td>
          <td class="px-6 py-3">
            <span [ngClass]="{ 
                            'bg-yellow-100 text-yellow-800': u.rol === 'ADMIN',
                            'bg-lime-100 text-lime-800': u.rol === 'AGRICULTOR',
                            'bg-blue-100 text-blue-800': u.rol === 'COMPRADOR',
                            'bg-purple-100 text-purple-800': u.rol === 'ANALISTA',
                            'bg-orange-100 text-orange-800': u.rol === 'TRANSPORTISTA' 
                        }" class="text-xs font-semibold px-2 py-0.5 rounded-full uppercase">
              {{ u.rol }}
            </span>
          </td>
          <td class="px-6 py-3 flex space-x-3 items-center">
            <button 
            (click)="abrirModal(u)"
            class="text-lime-600 p-2 rounded-lg bg-lime-50 hover:bg-lime-100 hover:text-lime-700 
                   transition transform hover:scale-110 shadow-sm"
            title="Editar Usuario">
            
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke-width="2" stroke="currentColor" class="h-6 w-6">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M16.862 4.487l1.414 1.414a2 2 0 010 2.828l-8.486 8.486L6 17l.785-3.789 8.486-8.486a2 2 0 012.828 0z"/>
            </svg>
          </button>

          <button 
          (click)="eliminarUsuario(u.id)"
          class="text-red-600 p-2 rounded-lg bg-red-50 hover:bg-red-100 hover:text-red-700 
                 transition transform hover:scale-110 shadow-sm"
          title="Eliminar Usuario">
      
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
            stroke-width="2" stroke="currentColor" class="h-6 w-6">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M6 7h12M9 7v10m6-10v10M4 5h16l-1 16H5L4 5z"/>
          </svg>
        </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal Crear/Editar Usuario -->
  <div *ngIf="modalVisible" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-xl shadow-2xl p-8 w-full max-w-lg relative transform transition-all duration-300">
      <h3 class="text-2xl font-bold mb-6 border-b pb-2 text-gray-800 flex items-center space-x-2">
        <span>{{ editUsuario ? 'Editar Usuario' : 'Crear Nuevo Usuario' }}</span>
      </h3>

      <form [formGroup]="userForm" (ngSubmit)="guardarUsuario()" class="space-y-4">
        <!-- Nombre -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Nombre</label>
          <input type="text" formControlName="nombre"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-lime-500 focus:border-lime-500 transition"
                 placeholder="Nombre completo" />
        </div>

        <!-- Email -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Email</label>
          <input type="email" formControlName="email"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-lime-500 focus:border-lime-500 transition"
                 placeholder="email@limochain.com" />
        </div>

        <!-- Teléfono -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Teléfono</label>
          <input type="text" formControlName="telefono"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-lime-500 focus:border-lime-500 transition"
                 placeholder="Ej. 3001234567" />
        </div>

        <!-- Rol -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Rol</label>
          <select formControlName="rol"
                  class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-white focus:ring-lime-500 focus:border-lime-500 transition">
            <option value="AGRICULTOR">Agricultor</option>
            <option value="COMPRADOR">Comprador</option>
            <option value="ANALISTA">Analista</option>
            <option value="TRANSPORTISTA">Transportista</option>
            <option value="ADMIN">Administrador</option>
          </select>
        </div>

        <!-- Password -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Contraseña (Solo si crea o cambia)</label>
          <input type="password" formControlName="password"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-lime-500 focus:border-lime-500 transition"
                 placeholder="Mínimo 6 caracteres" />
        </div>

        <!-- Confirmar Password -->
        <div *ngIf="!editUsuario || userForm.get('password')?.value" class="space-y-2">
          <label class="block text-sm font-medium text-gray-700">Confirmar Contraseña</label>
          <input type="password" formControlName="confirmPassword"
                 class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-lime-500 focus:border-lime-500 transition"
                 placeholder="Confirma la contraseña" />
        </div>

        <!-- Mensaje de error -->
        <p *ngIf="error"
           class="text-red-500 font-medium mt-2 p-2 bg-red-50 rounded-lg border border-red-200 flex items-center space-x-1">
          <span>{{ error }}</span>
        </p>

        <!-- Botones -->
        <div class="flex justify-end space-x-3 pt-4">
          <button type="button" (click)="cerrarModal()"
                  class="bg-gray-300 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-400 transition">
            Cancelar
          </button>
          <button type="submit"
                  class="bg-lime-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-lime-600 transition">
            {{ editUsuario ? 'Actualizar' : 'Crear' }}
          </button>
        </div>
      </form>

      <button (click)="cerrarModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 transition">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
             class="h-6 w-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mensaje temporal -->
  <div *ngIf="mensaje"
       class="fixed bottom-6 right-6 bg-lime-500 text-white px-6 py-3 rounded-lg shadow-lg transition-opacity duration-500 opacity-100 animate-fade-in-out z-50 flex items-center space-x-2">
    <span>{{ mensaje }}</span>
  </div>
</div>
